
<p>Since most of the integration features are optional, there are a number of ways to install Weathermap.
<ol>
    <li>Standalone - the traditional way</li>
    <li>Standalone, with editor - the option of some integration with your monitoring system</li>
    <li>Cacti plugin - integrated into your Cacti installation</li>
</ol></p>

<h3><a name ="install_standalone">Installing Standalone</a></h3>

<p>Unpack the zip file into a directory somewhere. If you intend to just use the 'traditional' hand-written text configuration files, then it can be anywhere on the same server that runs your data-collection software (MRTG, Cricket, Cacti).</p>

<p> You'll need to edit two lines in the <tt>weathermap</tt> file:
      <ul>
        <li>If you are on a Unix-based platform (BSD, OS X, Linux etc), the path in the very top line should be the full path to your command-line php executable</li>

        <li>Around line 20 or so, you may need to change the path to your rrdtool executable, if you are intending to use RRD-based datasources for your maps.</li>
      </ul>That should be it! You should be able to run
</p>
      <div class="shell">
        <tt>./weathermap</tt><br />
        or<br />
        <tt>php weathermap</tt> (on Windows)
      </div><p>from a shell or command prompt, and get a (rather boring) <tt>weathermap.png</tt> file in
      return. If you don't, you <i>should</i> get some kind of
      error to help you figure out why.</p>

<h3><a name ="install_cacti">Installing as a Cacti Plugin</a></h3>

<p>Before doing anything else, please verify that your Plugin Architecture is working properly with a simpler plugin, like Links or Tools. Weathermap is relatively complex, and fault-finding both your Cacti Plugin Architecture and Weathermap at the same time will make life harder for you!</p>
<p>To use the Cacti plugin, you <i>must</i> unpack the zip file into a directory called '<i>&lt;cacti_root&gt;</i>/plugins/weathermap'. </p>
<p>
    You will need to change the permissions on the <tt>output</tt> directory, so that the Cacti poller process can write to it. This is the same as you would have done for the <tt>rra</tt> directory while installing Cacti itself originally. For a *nix system, it will be something like:

<div class="shell"><pre>
chown cactiuser output
</pre></div>

</p>
<p>Then, edit your cacti <tt>config.php</tt> file and add a line:</p>
<div class="shell"><pre>
$plugins = array();
$plugins[] = 'monitor';
<b>$plugins[] = 'weathermap';</b>
</pre></div>
<p>
Now, refresh your Cacti page, to be sure that everything is still working right. If not, remove the line you just added and you should return to normal. Make a note of any error message and let me know!
</p>
<p>Assuming it all looks fine (but not very different), you can start to enable Weathermap. Log in as 'admin' or another user with User Management rights, go to the User Management section under Tools in the Cacti console, and then choose your own username from the list. Check the two new 'realms' boxes that should be there - View Weathermaps, and Manage Weathermaps - and then click Save. A 'Weathermap' tab should appear at the top of the page.</p>
<p>Before you start using it, you might want to change one PHP setting. Weathermap uses a fair bit of memory by PHP standards, as it builds the image for the map in memory before saving it. As a result, your PHP process <i>may</i> run out of memory. PHP has a 'safety valve' built-in, to stop runaway scripts from killing your server, which defaults to 8MB. This is controlled by the 'memory_limit =' line in php.ini. You may need to increase this to 16MB or 32MB if you have problems.</p>
<p>That's it! The Weathermap plugin is installed. To go further, you need some weathermap configuration files to define your maps. You can do this in two ways - using the Web-based map editor, or by editing the text-based configuration files directly.</p>
<p>To use the editor, you need to make a few more changes. </p>
<p>To learn more about actually <i>using</i> the Cacti plugin, see the <a href="cacti-plugin.html">Cacti Plugin page</a>.</p>

<h3><a name ="install_standaloneeditor">Configuring the Editor</a></h3>

<p>If you are intending to use the browser-based editor, then the directory that you unpack the zip file into should be within the 'web space' on the web server that runs your data-collection application (that is, Cacti, MRTG, or similar).</p>

<p>
    Start by following the instructions above for either a Standalone or Cacti Plugin installation. You will be running weathermap just the same way, but once you have a working <tt>weathermap</tt> (or plugin), you need to continue below:
</p>

<p>
Copy the <tt>editor-config.php-dist</tt> file to <tt>editor-config.php</tt>. If you use Cacti, and want to be able to pick data sources from your Cacti installation by name, edit the file and make sure that the line that sets <tt>$cacti_base</tt> is correct, and that the base URI below that is also correct for your Cacti installation (these two lines are marked CHANGE in the file).
</p>
<p>
Make sure that your webserver can write to the configs directory. To do this, you need to know which user your webserver runs as (maybe 'nobody', 'www' or 'httpd' on most *nixes) and then run:

<div class="shell">
<pre>chown www configs
chmod u+w configs</pre>
</div>

In a pinch, you can just <tt>chmod 777 configs</tt>, but this isn't really a recommended solution for a production system.</p>
<p>On Windows, the same applies - the user that runs the webserver runs as should have permissions to write new files, and change existing files in the configs folder.</p>
</p>
<p>
    You should now be able to go to http://yourserver/wherever-you-unpacked-weathermap/editor.php (or http://yourserver/cacti/plugins/weathermap/editor.php) in a browser, and get a welcome page that offers to load or create a config file. That's it. All done. Please see the <a href="editor.html">editor manual page</a> for more about <i>using</i> the editor!
</p>
<p>
    <strong>Important Security Note:</strong> The editor allows <i>anyone</i> who can access editor.php to change the configuration files for your network weathermaps. There is no authentication built-in for editing, even with the Cacti Plugin. This is why the configuration file doesn't exist by default - the editor won't work until you choose to make it work. It's recommended that you either: <ul><li>change the ownership of configuration files so that the editor can't write to them once they are complete, or </li><li>use your webserver's authentication and access control facilities to limit who can access the editor.php URL.</li></ul>

It's anticipated that a future version of Weathermap will include better integration with Cacti authentication for users of the Cacti Plugin version of this editor.
</p>
