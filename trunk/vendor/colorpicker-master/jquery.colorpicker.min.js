!function(o){"use strict"
var e=0,r='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',i='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',t='<div class="ui-colorpicker ui-colorpicker-inline"></div>',a=function(o){var e=Math.floor(o).toString(16)
return 1===e.length&&(e="0"+e),e.toLowerCase()},c=function(e){var r,i
return i=/^#?([a-fA-F0-9]{1,6})$/.exec(e),i?(r=parseInt(i[1],16),new o.colorpicker.Color((255&r>>16)/255,(255&r>>8)/255,(255&r)/255)):new o.colorpicker.Color},n=function(e,r){var i,t,a,c,n,l,s,p,u,h,g,b,d,k
for(e.sort(function(o,e){return o.pos[1]===e.pos[1]?o.pos[0]-e.pos[0]:o.pos[1]-e.pos[1]}),c=0,n=0,o.each(e,function(o,e){c=Math.max(c,e.pos[0]+e.pos[2]),n=Math.max(n,e.pos[1]+e.pos[3])}),i=[],t=0;c>t;++t)i.push([])
for(s=[],l=[],o.each(e,function(o,e){for(t=0;t<e.pos[2];t+=1)l[e.pos[0]+t]=!0
for(a=0;a<e.pos[3];a+=1)s[e.pos[1]+a]=!0}),h="",u=e[p=0],a=0;n>a;++a){for(h+="<tr>",t=0;c>t;)if(void 0!==u&&t===u.pos[0]&&a===u.pos[1]){for(h+=r(u,t,a),b=0;b<u.pos[3];b+=1)for(g=0;g<u.pos[2];g+=1)i[t+g][a+b]=!0
t+=u.pos[2],u=e[++p]}else{for(d=0,k=!1;c>t&&void 0===i[t][a]&&(void 0===u||a<u.pos[1]||a===u.pos[1]&&t<u.pos[0]);)l[t]===!0&&(d+=1),k=!0,t+=1
d>0?h+='<td colspan="'+d+'"></td>':k||(t+=1)}h+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+h+"</tbody></table>"}
o.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}},this.swatches={html:{black:{r:0,g:0,b:0},dimgray:{r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},gray:{r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},darkgray:{r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},silver:{r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},lightgrey:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},gainsboro:{r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},whitesmoke:{r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},indianred:{r:.803921568627451,g:.3607843137254902,b:.3607843137254902},brown:{r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},firebrick:{r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},lightcoral:{r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},maroon:{r:.5019607843137255,g:0,b:0},darkred:{r:.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:.9803921568627451,b:.9803921568627451},salmon:{r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},mistyrose:{r:1,g:.8941176470588236,b:.8823529411764706},tomato:{r:1,g:.38823529411764707,b:.2784313725490196},darksalmon:{r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},orangered:{r:1,g:.27058823529411763,b:0},coral:{r:1,g:.4980392156862745,b:.3137254901960784},lightsalmon:{r:1,g:.6274509803921569,b:.47843137254901963},sienna:{r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},seashell:{r:1,g:.9607843137254902,b:.9333333333333333},chocolate:{r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},saddlebrown:{r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},sandybrown:{r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},peachpuff:{r:1,g:.8549019607843137,b:.7254901960784313},peru:{r:.803921568627451,g:.5215686274509804,b:.24705882352941178},linen:{r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},darkorange:{r:1,g:.5490196078431373,b:0},bisque:{r:1,g:.8941176470588236,b:.7686274509803922},burlywood:{r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},tan:{r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},antiquewhite:{r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},navajowhite:{r:1,g:.8705882352941177,b:.6784313725490196},blanchedalmond:{r:1,g:.9215686274509803,b:.803921568627451},papayawhip:{r:1,g:.9372549019607843,b:.8352941176470589},orange:{r:1,g:.6470588235294118,b:0},moccasin:{r:1,g:.8941176470588236,b:.7098039215686275},wheat:{r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},oldlace:{r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},floralwhite:{r:1,g:.9803921568627451,b:.9411764705882353},goldenrod:{r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},darkgoldenrod:{r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},cornsilk:{r:1,g:.9725490196078431,b:.8627450980392157},gold:{r:1,g:.8431372549019608,b:0},palegoldenrod:{r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},khaki:{r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},lemonchiffon:{r:1,g:.9803921568627451,b:.803921568627451},darkkhaki:{r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},beige:{r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},lightgoldenrodyellow:{r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},olive:{r:.5019607843137255,g:.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:.8784313725490196},ivory:{r:1,g:1,b:.9411764705882353},olivedrab:{r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},yellowgreen:{r:.6039215686274509,g:.803921568627451,b:.19607843137254902},darkolivegreen:{r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},greenyellow:{r:.6784313725490196,g:1,b:.1843137254901961},lawngreen:{r:.48627450980392156,g:.9882352941176471,b:0},chartreuse:{r:.4980392156862745,g:1,b:0},darkseagreen:{r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},forestgreen:{r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},limegreen:{r:.19607843137254902,g:.803921568627451,b:.19607843137254902},lightgreen:{r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},palegreen:{r:.596078431372549,g:.984313725490196,b:.596078431372549},darkgreen:{r:0,g:.39215686274509803,b:0},green:{r:0,g:.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:.9411764705882353,g:1,b:.9411764705882353},mediumseagreen:{r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},seagreen:{r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},springgreen:{r:0,g:1,b:.4980392156862745},mintcream:{r:.9607843137254902,g:1,b:.9803921568627451},mediumspringgreen:{r:0,g:.9803921568627451,b:.6039215686274509},mediumaquamarine:{r:.4,g:.803921568627451,b:.6666666666666666},aquamarine:{r:.4980392156862745,g:1,b:.8313725490196079},turquoise:{r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},lightseagreen:{r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},mediumturquoise:{r:.2823529411764706,g:.8196078431372549,b:.8},darkslategray:{r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},paleturquoise:{r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},teal:{r:0,g:.5019607843137255,b:.5019607843137255},darkcyan:{r:0,g:.5450980392156862,b:.5450980392156862},darkturquoise:{r:0,g:.807843137254902,b:.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:.8784313725490196,g:1,b:1},azure:{r:.9411764705882353,g:1,b:1},cadetblue:{r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},powderblue:{r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},lightblue:{r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},deepskyblue:{r:0,g:.7490196078431373,b:1},skyblue:{r:.5294117647058824,g:.807843137254902,b:.9215686274509803},lightskyblue:{r:.5294117647058824,g:.807843137254902,b:.9803921568627451},steelblue:{r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},aliceblue:{r:.9411764705882353,g:.9725490196078431,b:1},dodgerblue:{r:.11764705882352941,g:.5647058823529412,b:1},slategray:{r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},lightslategray:{r:.4666666666666667,g:.5333333333333333,b:.6},lightsteelblue:{r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},cornflowerblue:{r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},royalblue:{r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},midnightblue:{r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},lavender:{r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},navy:{r:0,g:0,b:.5019607843137255},darkblue:{r:0,g:0,b:.5450980392156862},mediumblue:{r:0,g:0,b:.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:.9725490196078431,g:.9725490196078431,b:1},darkslateblue:{r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},slateblue:{r:.41568627450980394,g:.35294117647058826,b:.803921568627451},mediumslateblue:{r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},mediumpurple:{r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},blueviolet:{r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},indigo:{r:.29411764705882354,g:0,b:.5098039215686274},darkorchid:{r:.6,g:.19607843137254902,b:.8},darkviolet:{r:.5803921568627451,g:0,b:.8274509803921568},mediumorchid:{r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},thistle:{r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},plum:{r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},violet:{r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},purple:{r:.5019607843137255,g:0,b:.5019607843137255},darkmagenta:{r:.5450980392156862,g:0,b:.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},mediumvioletred:{r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},deeppink:{r:1,g:.0784313725490196,b:.5764705882352941},hotpink:{r:1,g:.4117647058823529,b:.7058823529411765},palevioletred:{r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},lavenderblush:{r:1,g:.9411764705882353,b:.9607843137254902},crimson:{r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},pink:{r:1,g:.7529411764705882,b:.796078431372549},lightpink:{r:1,g:.7137254901960784,b:.7568627450980392}}},this.writers={"#HEX":function(o,e){return e._formatColor("#rxgxbx",o)},"#HEX3":function(e){var r=o.colorpicker.writers.HEX3(e)
return r===!1?!1:"#"+r},HEX:function(o,e){return e._formatColor("rxgxbx",o)},HEX3:function(o){var e=o.getRGB(),r=Math.floor(255*e.r),i=Math.floor(255*e.g),t=Math.floor(255*e.b)
return r>>>4===(r&=15)&&i>>>4===(i&=15)&&t>>>4===(t&=15)?r.toString(16)+i.toString(16)+t.toString(16):!1},RGB:function(o,e){return o.getAlpha()>=1?e._formatColor("rgb(rd,gd,bd)",o):!1},RGBA:function(o,e){return e._formatColor("rgba(rd,gd,bd,af)",o)},"RGB%":function(o,e){return o.getAlpha()>=1?e._formatColor("rgb(rp%,gp%,bp%)",o):!1},"RGBA%":function(o,e){return e._formatColor("rgba(rp%,gp%,bp%,af)",o)},HSL:function(o,e){return o.getAlpha()>=1?e._formatColor("hsl(hd,sd,vd)",o):!1},HSLA:function(o,e){return e._formatColor("hsla(hd,sd,vd,af)",o)},"HSL%":function(o,e){return o.getAlpha()>=1?e._formatColor("hsl(hp%,sp%,vp%)",o):!1},"HSLA%":function(o,e){return e._formatColor("hsla(hp%,sp%,vp%,af)",o)},NAME:function(o,e){return e._closestName(o)},EXACT:function(o,e){return e._exactName(o)}},this.parsers={"":function(e){return""===e?new o.colorpicker.Color:void 0},NAME:function(e,r){var i=r._getSwatch(o.trim(e))
return i?new o.colorpicker.Color(i.r,i.g,i.b):void 0},RGBA:function(e){var r=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e)
return r?new o.colorpicker.Color(r[1]/255,r[2]/255,r[3]/255,parseFloat(r[4])):void 0},"RGBA%":function(e){var r=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e)
return r?new o.colorpicker.Color(r[1]/100,r[2]/100,r[3]/100,r[4]/100):void 0},HSLA:function(e){var r=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e)
return r?(new o.colorpicker.Color).setHSL(r[1]/255,r[2]/255,r[3]/255).setAlpha(parseFloat(r[4])):void 0},"HSLA%":function(e){var r=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e)
return r?(new o.colorpicker.Color).setHSL(r[1]/100,r[2]/100,r[3]/100).setAlpha(r[4]/100):void 0},"#HEX":function(e){var r=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e)
return r?new o.colorpicker.Color(parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255):void 0},"#HEX3":function(e){var r=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e)
return r?new o.colorpicker.Color(parseInt(r[1]+""+r[1],16)/255,parseInt(r[2]+""+r[2],16)/255,parseInt(r[3]+""+r[3],16)/255):void 0},HEX:function(e){var r=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e)
return r?new o.colorpicker.Color(parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255):void 0},HEX3:function(e){var r=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e)
return r?new o.colorpicker.Color(parseInt(r[1]+""+r[1],16)/255,parseInt(r[2]+""+r[2],16)/255,parseInt(r[3]+""+r[3],16)/255):void 0}},this.partslists={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},this.limits={websafe:function(o){o.limit(6)},nibble:function(o){o.limit(16)},binary:function(o){o.limit(2)},name:function(o,e){var r=e._getSwatch(e._closestName(o))
o.setRGB(r.r,r.g,r.b)}},this.parts={header:function(e){var r=null,i=function(){var o=e.options.title||e._getRegional("title"),r='<span class="ui-dialog-title">'+o+"</span>"
return!e.inline&&e.options.showCloseButton&&(r+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'),'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+r+"</div>"}
this.init=function(){r=o(i()).prependTo(e.dialog)
var t=o(".ui-dialog-titlebar-close",r)
e._hoverable(t),e._focusable(t),t.click(function(o){o.preventDefault(),e.close(e.options.revert)}),!e.inline&&e.options.draggable&&e.dialog.draggable({handle:r})}},map:function(e){var r,i,t,a,c=this,n=null
r=function(a){if(e.opened){var c=o(".ui-colorpicker-map-layer-pointer",n),l=c.offset(),s=c.width(),p=c.height(),u=a.pageX-l.left,h=a.pageY-l.top
u>=0&&s>u&&h>=0&&p>h&&(a.stopImmediatePropagation(),a.preventDefault(),n.unbind("mousedown",r),o(document).bind("mouseup",i),o(document).bind("mousemove",t),t(a))}},i=function(e){e.stopImmediatePropagation(),e.preventDefault(),o(document).unbind("mouseup",i),o(document).unbind("mousemove",t),n.bind("mousedown",r)},t=function(r){if(r.stopImmediatePropagation(),r.preventDefault(),r.pageX!==c.x||r.pageY!==c.y){c.x=r.pageX,c.y=r.pageY
var i=o(".ui-colorpicker-map-layer-pointer",n),t=i.offset(),a=i.width(),l=i.height(),s=r.pageX-t.left,p=r.pageY-t.top
switch(s=Math.max(0,Math.min(s/a,1)),p=Math.max(0,Math.min(p/l,1)),e.mode){case"h":e.color.setHSV(null,s,1-p)
break
case"s":case"a":e.color.setHSV(s,null,1-p)
break
case"v":e.color.setHSV(s,1-p,null)
break
case"r":e.color.setRGB(null,1-p,s)
break
case"g":e.color.setRGB(1-p,null,s)
break
case"b":e.color.setRGB(s,1-p,null)}e._change()}},a=function(){var o='<div class="ui-colorpicker-map ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(e.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'
return o},this.update=function(){switch(e.mode){case"h":o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 0",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).hide()
break
case"s":case"a":o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 -260px",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).css({"background-position":"0 -520px",opacity:""}).show()
break
case"v":o(n).css("background-color","black"),o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 -780px",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).hide()
break
case"r":o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 -1040px",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).css({"background-position":"0 -1300px",opacity:""}).show()
break
case"g":o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 -1560px",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).css({"background-position":"0 -1820px",opacity:""}).show()
break
case"b":o(".ui-colorpicker-map-layer-1",n).css({"background-position":"0 -2080px",opacity:""}).show(),o(".ui-colorpicker-map-layer-2",n).css({"background-position":"0 -2340px",opacity:""}).show()}c.repaint()},this.repaint=function(){var r=o(".ui-colorpicker-map-layer-pointer",n),i=0,t=0
switch(e.mode){case"h":i=e.color.getHSV().s*r.width(),t=(1-e.color.getHSV().v)*r.width(),o(n).css("background-color",e.color.copy().setHSV(null,1,1).toCSS())
break
case"s":case"a":i=e.color.getHSV().h*r.width(),t=(1-e.color.getHSV().v)*r.width(),o(".ui-colorpicker-map-layer-2",n).css("opacity",1-e.color.getHSV().s)
break
case"v":i=e.color.getHSV().h*r.width(),t=(1-e.color.getHSV().s)*r.width(),o(".ui-colorpicker-map-layer-1",n).css("opacity",e.color.getHSV().v)
break
case"r":i=e.color.getRGB().b*r.width(),t=(1-e.color.getRGB().g)*r.width(),o(".ui-colorpicker-map-layer-2",n).css("opacity",e.color.getRGB().r)
break
case"g":i=e.color.getRGB().b*r.width(),t=(1-e.color.getRGB().r)*r.width(),o(".ui-colorpicker-map-layer-2",n).css("opacity",e.color.getRGB().g)
break
case"b":i=e.color.getRGB().r*r.width(),t=(1-e.color.getRGB().g)*r.width(),o(".ui-colorpicker-map-layer-2",n).css("opacity",e.color.getRGB().b)}e.options.alpha&&o(".ui-colorpicker-map-layer-alpha",n).css("opacity",1-e.color.getAlpha()),o(".ui-colorpicker-map-pointer",n).css({left:i-7,top:t-7})},this.init=function(){n=o(a()).appendTo(o(".ui-colorpicker-map-container",e.dialog)),n.bind("mousedown",r)}},bar:function(e){var r,i,t,a,c=this,n=null
r=function(a){if(e.opened){var c=o(".ui-colorpicker-bar-layer-pointer",n),l=c.offset(),s=c.width(),p=c.height(),u=a.pageX-l.left,h=a.pageY-l.top
u>=0&&s>u&&h>=0&&p>h&&(a.stopImmediatePropagation(),a.preventDefault(),n.unbind("mousedown",r),o(document).bind("mouseup",i),o(document).bind("mousemove",t),t(a))}},i=function(e){e.stopImmediatePropagation(),e.preventDefault(),o(document).unbind("mouseup",i),o(document).unbind("mousemove",t),n.bind("mousedown",r)},t=function(r){if(r.stopImmediatePropagation(),r.preventDefault(),r.pageY!==c.y){c.y=r.pageY
var i=o(".ui-colorpicker-bar-layer-pointer",n),t=i.offset(),a=i.height(),l=r.pageY-t.top
switch(l=Math.max(0,Math.min(l/a,1)),e.mode){case"h":e.color.setHSV(1-l,null,null)
break
case"s":e.color.setHSV(null,1-l,null)
break
case"v":e.color.setHSV(null,null,1-l)
break
case"r":e.color.setRGB(1-l,null,null)
break
case"g":e.color.setRGB(null,1-l,null)
break
case"b":e.color.setRGB(null,null,1-l)
break
case"a":e.color.setAlpha(1-l)}e._change()}},a=function(){var o='<div class="ui-colorpicker-bar ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>'
return e.options.alpha&&(o+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'),o+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'},this.update=function(){switch(e.mode){case"h":case"s":case"v":case"r":case"g":case"b":o(".ui-colorpicker-bar-layer-alpha",n).show(),o(".ui-colorpicker-bar-layer-alphabar",n).hide()
break
case"a":o(".ui-colorpicker-bar-layer-alpha",n).hide(),o(".ui-colorpicker-bar-layer-alphabar",n).show()}switch(e.mode){case"h":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 0",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).hide(),o(".ui-colorpicker-bar-layer-3",n).hide(),o(".ui-colorpicker-bar-layer-4",n).hide()
break
case"s":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 -260px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).css({"background-position":"0 -520px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-3",n).hide(),o(".ui-colorpicker-bar-layer-4",n).hide()
break
case"v":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 -520px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).hide(),o(".ui-colorpicker-bar-layer-3",n).hide(),o(".ui-colorpicker-bar-layer-4",n).hide()
break
case"r":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 -1560px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).css({"background-position":"0 -1300px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-3",n).css({"background-position":"0 -780px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-4",n).css({"background-position":"0 -1040px",opacity:""}).show()
break
case"g":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 -2600px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).css({"background-position":"0 -2340px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-3",n).css({"background-position":"0 -1820px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-4",n).css({"background-position":"0 -2080px",opacity:""}).show()
break
case"b":o(".ui-colorpicker-bar-layer-1",n).css({"background-position":"0 -3640px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-2",n).css({"background-position":"0 -3380px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-3",n).css({"background-position":"0 -2860px",opacity:""}).show(),o(".ui-colorpicker-bar-layer-4",n).css({"background-position":"0 -3120px",opacity:""}).show()
break
case"a":o(".ui-colorpicker-bar-layer-1",n).hide(),o(".ui-colorpicker-bar-layer-2",n).hide(),o(".ui-colorpicker-bar-layer-3",n).hide(),o(".ui-colorpicker-bar-layer-4",n).hide()}c.repaint()},this.repaint=function(){var r=o(".ui-colorpicker-bar-layer-pointer",n),i=0
switch(e.mode){case"h":i=(1-e.color.getHSV().h)*r.height()
break
case"s":i=(1-e.color.getHSV().s)*r.height(),o(".ui-colorpicker-bar-layer-2",n).css("opacity",1-e.color.getHSV().v),o(n).css("background-color",e.color.copy().setHSV(null,1,null).toCSS())
break
case"v":i=(1-e.color.getHSV().v)*r.height(),o(n).css("background-color",e.color.copy().setHSV(null,null,1).toCSS())
break
case"r":i=(1-e.color.getRGB().r)*r.height(),o(".ui-colorpicker-bar-layer-2",n).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().g)),o(".ui-colorpicker-bar-layer-3",n).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().b)),o(".ui-colorpicker-bar-layer-4",n).css("opacity",Math.min(e.color.getRGB().b,e.color.getRGB().g))
break
case"g":i=(1-e.color.getRGB().g)*r.height(),o(".ui-colorpicker-bar-layer-2",n).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().r)),o(".ui-colorpicker-bar-layer-3",n).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().b)),o(".ui-colorpicker-bar-layer-4",n).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().b))
break
case"b":i=(1-e.color.getRGB().b)*r.height(),o(".ui-colorpicker-bar-layer-2",n).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().g)),o(".ui-colorpicker-bar-layer-3",n).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().r)),o(".ui-colorpicker-bar-layer-4",n).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().g))
break
case"a":i=(1-e.color.getAlpha())*r.height(),o(n).css("background-color",e.color.copy().toCSS())}"a"!==e.mode&&o(".ui-colorpicker-bar-layer-alpha",n).css("opacity",1-e.color.getAlpha()),o(".ui-colorpicker-bar-pointer",n).css("top",i-3)},this.init=function(){n=o(a()).appendTo(o(".ui-colorpicker-bar-container",e.dialog)),n.bind("mousedown",r)}},preview:function(e){var r,i=null
r=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>'},this.init=function(){i=o(r()).appendTo(o(".ui-colorpicker-preview-container",e.dialog)),o(".ui-colorpicker-preview-initial",i).click(function(){e.color=e.currentColor.copy(),e._change(e.color.set)})},this.update=function(){e.options.alpha?o(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).show():o(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).hide(),this.repaint()},this.repaint=function(){o(".ui-colorpicker-preview-initial",i).css("background-color",e.currentColor.set?e.currentColor.toCSS():"").attr("title",e.currentColor.set?e.currentColor.toCSS():""),o(".ui-colorpicker-preview-initial-alpha",i).css("opacity",1-e.currentColor.getAlpha()),o(".ui-colorpicker-preview-current",i).css("background-color",e.color.set?e.color.toCSS():"").attr("title",e.color.set?e.color.toCSS():""),o(".ui-colorpicker-preview-current-alpha",i).css("opacity",1-e.color.getAlpha())}},hsv:function(e){var r,i=null
r=function(){var o=""
return e.options.hsv&&(o+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+e._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div>'+'<div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+e._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+e._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-hsv">'+o+"</div>"},this.init=function(){i=o(r()).appendTo(o(".ui-colorpicker-hsv-container",e.dialog)),o(".ui-colorpicker-mode",i).click(function(){e.mode=o(this).val(),e._updateAllParts()}),o(".ui-colorpicker-number",i).bind("change keyup",function(){e.color.setHSV(o(".ui-colorpicker-hsv-h .ui-colorpicker-number",i).val()/360,o(".ui-colorpicker-hsv-s .ui-colorpicker-number",i).val()/100,o(".ui-colorpicker-hsv-v .ui-colorpicker-number",i).val()/100),e._change()})},this.repaint=function(){var r=e.color.getHSV()
r.h*=360,r.s*=100,r.v*=100,o.each(r,function(e,r){var t=o(".ui-colorpicker-hsv-"+e+" .ui-colorpicker-number",i)
r=Math.round(r),parseInt(t.val(),10)!==r&&t.val(r)})},this.update=function(){o(".ui-colorpicker-mode",i).each(function(){o(this).attr("checked",o(this).val()===e.mode)}),this.repaint()}},rgb:function(e){var r,i=null
r=function(){var o=""
return e.options.rgb&&(o+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+e._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+e._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+e._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'),'<div class="ui-colorpicker-rgb">'+o+"</div>"},this.init=function(){i=o(r()).appendTo(o(".ui-colorpicker-rgb-container",e.dialog)),o(".ui-colorpicker-mode",i).click(function(){e.mode=o(this).val(),e._updateAllParts()}),o(".ui-colorpicker-number",i).bind("change keyup",function(){o(".ui-colorpicker-rgb-r .ui-colorpicker-number",i).val(),e.color.setRGB(o(".ui-colorpicker-rgb-r .ui-colorpicker-number",i).val()/255,o(".ui-colorpicker-rgb-g .ui-colorpicker-number",i).val()/255,o(".ui-colorpicker-rgb-b .ui-colorpicker-number",i).val()/255),e._change()})},this.repaint=function(){o.each(e.color.getRGB(),function(e,r){var t=o(".ui-colorpicker-rgb-"+e+" .ui-colorpicker-number",i)
r=Math.floor(255*r),parseInt(t.val(),10)!==r&&t.val(r)})},this.update=function(){o(".ui-colorpicker-mode",i).each(function(){o(this).attr("checked",o(this).val()===e.mode)}),this.repaint()}},lab:function(e){var r=null,i=function(){var o=""
return e.options.hsv&&(o+='<div class="ui-colorpicker-lab-l"><label>'+e._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div>'+'<div class="ui-colorpicker-lab-a"><label>'+e._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'+'<div class="ui-colorpicker-lab-b"><label>'+e._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'),'<div class="ui-colorpicker-lab">'+o+"</div>"}
this.init=function(){r=o(i()).appendTo(o(".ui-colorpicker-lab-container",e.dialog)),o(".ui-colorpicker-number",r).bind("change keyup",function(){e.color.setLAB(parseInt(o(".ui-colorpicker-lab-l .ui-colorpicker-number",r).val(),10)/100,(parseInt(o(".ui-colorpicker-lab-a .ui-colorpicker-number",r).val(),10)+128)/255,(parseInt(o(".ui-colorpicker-lab-b .ui-colorpicker-number",r).val(),10)+128)/255),e._change()})},this.repaint=function(){var i=e.color.getLAB()
i.l*=100,i.a=255*i.a-128,i.b=255*i.b-128,o.each(i,function(e,i){var t=o(".ui-colorpicker-lab-"+e+" .ui-colorpicker-number",r)
i=Math.round(i),parseInt(t.val(),10)!==i&&t.val(i)})},this.update=function(){this.repaint()}},cmyk:function(e){var r=null,i=function(){var o=""
return e.options.hsv&&(o+='<div class="ui-colorpicker-cmyk-c"><label>'+e._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-m"><label>'+e._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-y"><label>'+e._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-k"><label>'+e._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-cmyk">'+o+"</div>"}
this.init=function(){r=o(i()).appendTo(o(".ui-colorpicker-cmyk-container",e.dialog)),o(".ui-colorpicker-number",r).bind("change keyup",function(){e.color.setCMYK(parseInt(o(".ui-colorpicker-cmyk-c .ui-colorpicker-number",r).val(),10)/100,parseInt(o(".ui-colorpicker-cmyk-m .ui-colorpicker-number",r).val(),10)/100,parseInt(o(".ui-colorpicker-cmyk-y .ui-colorpicker-number",r).val(),10)/100,parseInt(o(".ui-colorpicker-cmyk-k .ui-colorpicker-number",r).val(),10)/100),e._change()})},this.repaint=function(){o.each(e.color.getCMYK(),function(e,i){var t=o(".ui-colorpicker-cmyk-"+e+" .ui-colorpicker-number",r)
i=Math.round(100*i),parseInt(t.val(),10,10)!==i&&t.val(i)})},this.update=function(){this.repaint()}},alpha:function(e){var r,i=null
r=function(){var o=""
return e.options.alpha&&(o+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+e._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-alpha">'+o+"</div>"},this.init=function(){i=o(r()).appendTo(o(".ui-colorpicker-alpha-container",e.dialog)),o(".ui-colorpicker-mode",i).click(function(){e.mode=o(this).val(),e._updateAllParts()}),o(".ui-colorpicker-number",i).bind("change keyup",function(){e.color.setAlpha(o(".ui-colorpicker-a .ui-colorpicker-number",i).val()/100),e._change()})},this.update=function(){o(".ui-colorpicker-mode",i).each(function(){o(this).attr("checked",o(this).val()===e.mode)}),this.repaint()},this.repaint=function(){var r=o(".ui-colorpicker-a .ui-colorpicker-number",i),t=Math.round(100*e.color.getAlpha())
parseInt(r.val(),10)!==t&&r.val(t)}},hex:function(e){var r,i=null
r=function(){var o=""
return e.options.alpha&&(o+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'),o+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>','<div class="ui-colorpicker-hex"><label>#</label>'+o+"</div>"},this.init=function(){i=o(r()).appendTo(o(".ui-colorpicker-hex-container",e.dialog)),o(".ui-colorpicker-hex-input",i).bind("change keydown keyup",function(){/[^a-fA-F0-9]/.test(o(this).val())&&o(this).val(o(this).val().replace(/[^a-fA-F0-9]/,""))}),o(".ui-colorpicker-hex-input",i).bind("change keyup",function(){e.color=c(o(this).val()).setAlpha(e.color.getAlpha()),e._change()}),o(".ui-colorpicker-hex-alpha",i).bind("change keydown keyup",function(){/[^a-fA-F0-9]/.test(o(this).val())&&o(this).val(o(this).val().replace(/[^a-fA-F0-9]/,""))}),o(".ui-colorpicker-hex-alpha",i).bind("change keyup",function(){e.color.setAlpha(parseInt(o(".ui-colorpicker-hex-alpha",i).val(),16)/255),e._change()})},this.update=function(){this.repaint()},this.repaint=function(){o(".ui-colorpicker-hex-input",i).is(":focus")||o(".ui-colorpicker-hex-input",i).val(e.color.toHex(!0)),o(".ui-colorpicker-hex-alpha",i).is(":focus")||o(".ui-colorpicker-hex-alpha",i).val(a(255*e.color.getAlpha()))}},swatches:function(e){var r=null,i=function(){var r=""
return o.each(e._getSwatches(),function(e,i){var t=new o.colorpicker.Color(i.r,i.g,i.b),a=t.toCSS()
r+='<div class="ui-colorpicker-swatch" style="background-color:'+a+'" title="'+e+'"></div>'}),'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+e.options.swatchesWidth+'px">'+r+"</div>"}
this.init=function(){r=o(i()).appendTo(o(".ui-colorpicker-swatches-container",e.dialog)),o(".ui-colorpicker-swatch",r).click(function(){e.color=e._parseColor(o(this).css("background-color")),e._change()})}},footer:function(r){var i=null,t="ui-colorpicker-special-transparent-"+e,a="ui-colorpicker-special-none-"+e,c=function(){var o=""
return(r.options.alpha||!r.inline&&r.options.showNoneButton)&&(o+='<div class="ui-colorpicker-buttonset">',r.options.alpha&&(o+='<input type="radio" name="ui-colorpicker-special" id="'+t+'" class="ui-colorpicker-special-transparent"/><label for="'+t+'">'+r._getRegional("transparent")+"</label>"),!r.inline&&r.options.showNoneButton&&(o+='<input type="radio" name="ui-colorpicker-special" id="'+a+'" class="ui-colorpicker-special-none"><label for="'+a+'">'+r._getRegional("none")+"</label>"),o+="</div>"),r.inline||(o+='<div class="ui-dialog-buttonset">',r.options.showCancelButton&&(o+='<button class="ui-colorpicker-cancel">'+r._getRegional("cancel")+"</button>"),o+='<button class="ui-colorpicker-ok">'+r._getRegional("ok")+"</button>",o+="</div>"),'<div class="ui-dialog-buttonpane ui-widget-content">'+o+"</div>"}
this.init=function(){i=o(c()).appendTo(r.dialog),o(".ui-colorpicker-ok",i).button().click(function(){r.close()}),o(".ui-colorpicker-cancel",i).button().click(function(){r.close(!0)}),o(".ui-colorpicker-buttonset",i).buttonset(),o(".ui-colorpicker-special-color",i).click(function(){r._change()}),o("#"+a,i).click(function(){r._change(!1)}),o("#"+t,i).click(function(){r.color.setAlpha(0),r._change()})},this.repaint=function(){r.color.set?0===r.color.getAlpha()?o(".ui-colorpicker-special-transparent",i).attr("checked",!0).button("refresh"):o("input",i).attr("checked",!1).button("refresh"):o(".ui-colorpicker-special-none",i).attr("checked",!0).button("refresh"),o(".ui-colorpicker-cancel",i).button(r.changed?"enable":"disable")},this.update=function(){}}},this.Color=function(){var e={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},r=1,i=[.9504285,1,1.0889],t=arguments,a=function(o){return isNaN(o)||null===o?0:("string"==typeof o&&(o=parseInt(o,10)),Math.max(0,Math.min(o,1)))},c=function(o){var e="0123456789abcdef",r=o%16,i=(o-r)/16,t=e.charAt(i)+e.charAt(r)
return t},n=function(o){var e=o.r>.04045?Math.pow((o.r+.055)/1.055,2.4):o.r/12.92,r=o.g>.04045?Math.pow((o.g+.055)/1.055,2.4):o.g/12.92,i=o.b>.04045?Math.pow((o.b+.055)/1.055,2.4):o.b/12.92
return{x:.4124*e+.3576*r+.1805*i,y:.2126*e+.7152*r+.0722*i,z:.0193*e+.1192*r+.9505*i}},l=function(o){var e={r:3.2406*o.x+-1.5372*o.y+o.z*-.4986,g:o.x*-.9689+1.8758*o.y+.0415*o.z,b:.0557*o.x+o.y*-.204+1.057*o.z}
return e.r=e.r>.0031308?1.055*Math.pow(e.r,1/2.4)-.055:12.92*e.r,e.g=e.g>.0031308?1.055*Math.pow(e.g,1/2.4)-.055:12.92*e.g,e.b=e.b>.0031308?1.055*Math.pow(e.b,1/2.4)-.055:12.92*e.b,e},s=function(o){var e,r,i,t=Math.min(o.r,o.g,o.b),a=Math.max(o.r,o.g,o.b),c=a-t,n={h:0,s:0,v:a}
return 0===c?(n.h=0,n.s=0):(n.s=c/a,e=((a-o.r)/6+c/2)/c,r=((a-o.g)/6+c/2)/c,i=((a-o.b)/6+c/2)/c,o.r===a?n.h=i-r:o.g===a?n.h=1/3+e-i:o.b===a&&(n.h=2/3+r-e),n.h<0?n.h+=1:n.h>1&&(n.h-=1)),n},p=function(o){var e,r,i,t,a,c={r:0,g:0,b:0}
return 0===o.s?c.r=c.g=c.b=o.v:(e=1===o.h?0:6*o.h,r=Math.floor(e),i=o.v*(1-o.s),t=o.v*(1-o.s*(e-r)),a=o.v*(1-o.s*(1-(e-r))),0===r?(c.r=o.v,c.g=a,c.b=i):1===r?(c.r=t,c.g=o.v,c.b=i):2===r?(c.r=i,c.g=o.v,c.b=a):3===r?(c.r=i,c.g=t,c.b=o.v):4===r?(c.r=a,c.g=i,c.b=o.v):(c.r=o.v,c.g=i,c.b=t)),c},u=function(o){var e,r,i,t=Math.min(o.r,o.g,o.b),a=Math.max(o.r,o.g,o.b),c=a-t,n={h:0,s:0,l:(a+t)/2}
return 0===c?(n.h=0,n.s=0):(n.s=n.l<.5?c/(a+t):c/(2-a-t),e=((a-o.r)/6+c/2)/c,r=((a-o.g)/6+c/2)/c,i=((a-o.b)/6+c/2)/c,o.r===a?n.h=i-r:o.g===a?n.h=1/3+e-i:o.b===a&&(n.h=2/3+r-e),n.h<0?n.h+=1:n.h>1&&(n.h-=1)),n},h=function(o){var e,r,i=function(o,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1>6*r?o+6*(e-o)*r:1>2*r?e:2>3*r?o+6*(e-o)*(2/3-r):o}
return 0===o.s?{r:o.l,g:o.l,b:o.l}:(r=o.l<.5?o.l*(1+o.s):o.l+o.s-o.s*o.l,e=2*o.l-r,{r:i(e,r,o.h+1/3),g:i(e,r,o.h),b:i(e,r,o.h-1/3)})},g=function(o){var e=o.x/i[0],r=o.y/i[1],t=o.z/i[2]
return e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,{l:(116*r-16)/100,a:(500*(e-r)+128)/255,b:(200*(r-t)+128)/255}},b=function(o){var e={l:100*o.l,a:255*o.a-128,b:255*o.b-128},r={x:0,y:(e.l+16)/116,z:0}
return r.x=e.a/500+r.y,r.z=r.y-e.b/200,r.x=Math.pow(r.x,3)>.008856?Math.pow(r.x,3):(r.x-16/116)/7.787,r.y=Math.pow(r.y,3)>.008856?Math.pow(r.y,3):(r.y-16/116)/7.787,r.z=Math.pow(r.z,3)>.008856?Math.pow(r.z,3):(r.z-16/116)/7.787,r.x*=i[0],r.y*=i[1],r.z*=i[2],r},d=function(o){return{c:1-o.r,m:1-o.g,y:1-o.b}},k=function(o){return{r:1-o.c,g:1-o.m,b:1-o.y}},m=function(o){var e=1
return o.c<e&&(e=o.c),o.m<e&&(e=o.m),o.y<e&&(e=o.y),1===e?{c:0,m:0,y:0,k:1}:{c:(o.c-e)/(1-e),m:(o.m-e)/(1-e),y:(o.y-e)/(1-e),k:e}},v=function(o){return{c:o.c*(1-o.k)+o.k,m:o.m*(1-o.k)+o.k,y:o.y*(1-o.k)+o.k}}
this.set=!1,this.setAlpha=function(o){return null!==o&&(r=a(o)),this},this.getAlpha=function(){return r},this.setRGB=function(o,r,i){return e={rgb:this.getRGB()},null!==o&&(e.rgb.r=a(o)),null!==r&&(e.rgb.g=a(r)),null!==i&&(e.rgb.b=a(i)),this},this.setHSV=function(o,r,i){return e={hsv:this.getHSV()},null!==o&&(e.hsv.h=a(o)),null!==r&&(e.hsv.s=a(r)),null!==i&&(e.hsv.v=a(i)),this},this.setHSL=function(o,r,i){return e={hsl:this.getHSL()},null!==o&&(e.hsl.h=a(o)),null!==r&&(e.hsl.s=a(r)),null!==i&&(e.hsl.l=a(i)),this},this.setLAB=function(o,r,i){return e={lab:this.getLAB()},null!==o&&(e.lab.l=a(o)),null!==r&&(e.lab.a=a(r)),null!==i&&(e.lab.b=a(i)),this},this.setCMYK=function(o,r,i,t){return e={cmyk:this.getCMYK()},null!==o&&(e.cmyk.c=a(o)),null!==r&&(e.cmyk.m=a(r)),null!==i&&(e.cmyk.y=a(i)),null!==t&&(e.cmyk.k=a(t)),this},this.getRGB=function(){return e.rgb||(e.rgb=e.lab?l(b(e.lab)):e.hsv?p(e.hsv):e.hsl?h(e.hsl):e.cmyk?k(v(e.cmyk)):{r:0,g:0,b:0},e.rgb.r=a(e.rgb.r),e.rgb.g=a(e.rgb.g),e.rgb.b=a(e.rgb.b)),o.extend({},e.rgb)},this.getHSV=function(){return e.hsv||(e.hsv=e.lab?s(this.getRGB()):e.rgb?s(e.rgb):e.hsl?s(this.getRGB()):e.cmyk?s(this.getRGB()):{h:0,s:0,v:0},e.hsv.h=a(e.hsv.h),e.hsv.s=a(e.hsv.s),e.hsv.v=a(e.hsv.v)),o.extend({},e.hsv)},this.getHSL=function(){return e.hsl||(e.hsl=e.rgb?u(e.rgb):e.hsv?u(this.getRGB()):e.cmyk?u(this.getRGB()):e.hsv?u(this.getRGB()):{h:0,s:0,l:0},e.hsl.h=a(e.hsl.h),e.hsl.s=a(e.hsl.s),e.hsl.l=a(e.hsl.l)),o.extend({},e.hsl)},this.getCMYK=function(){return e.cmyk||(e.cmyk=e.rgb?m(d(e.rgb)):e.hsv?m(d(this.getRGB())):e.hsl?m(d(this.getRGB())):e.lab?m(d(this.getRGB())):{c:0,m:0,y:0,k:1},e.cmyk.c=a(e.cmyk.c),e.cmyk.m=a(e.cmyk.m),e.cmyk.y=a(e.cmyk.y),e.cmyk.k=a(e.cmyk.k)),o.extend({},e.cmyk)},this.getLAB=function(){return e.lab||(e.lab=e.rgb?g(n(e.rgb)):e.hsv?g(n(this.getRGB())):e.hsl?g(n(this.getRGB())):e.cmyk?g(n(this.getRGB())):{l:0,a:0,b:0},e.lab.l=a(e.lab.l),e.lab.a=a(e.lab.a),e.lab.b=a(e.lab.b)),o.extend({},e.lab)},this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}},this.getSpaces=function(){return o.extend(!0,{},e)},this.setSpaces=function(o){return e=o,this},this.distance=function(o){var e,r="lab",i="get"+r.toUpperCase(),t=this[i](),a=o[i](),c=0
for(e in t)c+=Math.pow(t[e]-a[e],2)
return c},this.equals=function(o){var e=this.getRGB(),r=o.getRGB()
return this.getAlpha()===o.getAlpha()&&e.r===r.r&&e.g===r.g&&e.b===r.b},this.limit=function(o){o-=1
var e=this.getRGB()
this.setRGB(Math.round(e.r*o)/o,Math.round(e.g*o)/o,Math.round(e.b*o)/o)},this.toHex=function(){var o=this.getRGB()
return c(255*o.r)+c(255*o.g)+c(255*o.b)},this.toCSS=function(){return"#"+this.toHex()},this.copy=function(){var e=new o.colorpicker.Color(this.getSpaces(),this.getAlpha())
return e.set=this.set,e},2===t.length&&(this.setSpaces(t[0]),this.setAlpha(0===t[1]?0:t[1]||1),this.set=!0),t.length>2&&(this.setRGB(t[0],t[1],t[2]),this.setAlpha(0===t[3]?0:t[3]||1),this.set=!0)}},o.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonClass:null,buttonColorize:!1,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",draggable:!0,duration:"fast",hsv:!0,inline:!0,inlineFrame:!0,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",okOnEnter:!1,parts:"",regional:"",revert:!1,rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,close:null,init:null,select:null,ok:null,open:null},_create:function(){var r,i=this
return++e,i.widgetEventPrefix="colorpicker",i.opened=!1,i.generated=!1,i.inline=!1,i.changed=!1,i.dialog=null,i.button=null,i.image=null,i.overlay=null,i.mode=i.options.mode,i.element.is("input")||i.options.inline===!1?(i._setColor(i.element.is("input")?i.element.val():i.options.color),i._callback("init"),/\bfocus|both\b/.test(i.options.showOn)&&i.element.bind("focus",function(){i.open()}),/\bclick|both\b/.test(i.options.showOn)&&i.element.bind("click",function(){i.open()}),/\bbutton|both\b/.test(i.options.showOn)&&(""!==i.options.buttonImage&&(r=i.options.buttonText||i._getRegional("button"),i.image=o("<img/>").attr({src:i.options.buttonImage,alt:r,title:r}),i.options.buttonClass&&i.image.attr("class",i.options.buttonClass),i._setImageBackground()),i.options.buttonImageOnly&&i.image?i.button=i.image:(i.button=o('<button type="button"></button>').html(i.image||i.options.buttonText).button(),i.image=i.image?o("img",i.button).first():null),i.button.insertAfter(i.element).click(function(){i[i.opened?"close":"open"]()})),/\balt|both\b/.test(i.options.showOn)&&o(i.options.altField).bind("click",function(){i.open()}),i.options.autoOpen&&i.open()):(i.inline=!0,i._generate(),i.opened=!0),this},_setOption:function(e,r){var i=this
switch(e){case"disabled":r?i.dialog.addClass("ui-colorpicker-disabled"):i.dialog.removeClass("ui-colorpicker-disabled")}o.Widget.prototype._setOption.apply(i,arguments)},_setImageBackground:function(){this.image&&this.options.buttonColorize&&this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var e,r,i=this.options.altProperties.split(",")
for(e=0;e<=i.length;++e)switch(r=o.trim(i[e])){case"color":case"background-color":case"backgroundColor":case"outline-color":case"border-color":o(this.options.altField).css(r,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&o(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(o){this.color=this._parseColor(o),this.currentColor=this.color.copy(),this._setImageBackground(),this._setAltField()},setColor:function(o){this._setColor(o),this._change(this.color.set)},_generateInline:function(){var e=this
o(e.element).html(e.options.inlineFrame?i:t),e.dialog=o(".ui-colorpicker",e.element)},_generatePopup:function(){var e=this
o("body").append(r),e.dialog=o(".ui-colorpicker:last"),o(document).delegate("html","touchstart click",function(r){if(e.opened&&r.target!==e.element[0]&&!e.overlay){if(e.dialog.is(r.target)||e.dialog.has(r.target).length>0)return e.element.blur(),void 0
var i,t=o(r.target).parents()
for(t.push(r.target),i=0;i<=t.length;++i){if(null!==e.button&&t[i]===e.button[0])return
if(/\balt|both\b/.test(e.options.showOn)&&o(e.options.altField).is(t[i]))return}e.options.closeOnOutside&&e.close(e.options.revert)}}),o(document).keydown(function(o){e.opened&&27===o.keyCode&&e.options.closeOnEscape&&e.close(e.options.revert),e.opened&&13===o.keyCode&&e.options.okOnEnter&&e.close()}),e.element.keydown(function(o){9===o.keyCode&&e.close()}).keyup(function(){var o=e._parseColor(e.element.val())
e.color.equals(o)||(e.color=o,e._change())})},_generate:function(){var e,r,i,t,a=this
a._setColor(a.inline||!a.element.is("input")?a.options.color:a.element.val()),a[a.inline?"_generateInline":"_generatePopup"](),e="string"==typeof a.options.parts?o.colorpicker.partslists[a.options.parts]?o.colorpicker.partslists[a.options.parts]:o.colorpicker.partslists[a.inline?"inline":"popup"]:a.options.parts,a.parts={},o.each(e,function(e,r){o.colorpicker.parts[r]&&(a.parts[r]=new o.colorpicker.parts[r](a))}),a.generated||(r=[],o.each(a.options.layout,function(o,e){a.parts[o]&&r.push({part:o,pos:e})}),i=o(n(r,function(o,e,r){return t=["ui-colorpicker-"+o.part+"-container"],e>0&&t.push("ui-colorpicker-padding-left"),r>0&&t.push("ui-colorpicker-padding-top"),'<td  class="'+t.join(" ")+'"'+(o.pos[2]>1?' colspan="'+o.pos[2]+'"':"")+(o.pos[3]>1?' rowspan="'+o.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(a.dialog),a.options.inlineFrame&&i.addClass("ui-dialog-content ui-widget-content"),a._initAllParts(),a._updateAllParts(),a.generated=!0)},_effectGeneric:function(e,r,i,t,a){var c=this
o.effects&&o.effects[c.options.showAnim]?e[r](c.options.showAnim,c.options.showOptions,c.options.duration,a):(e["slideDown"===c.options.showAnim?i:"fadeIn"===c.options.showAnim?t:r](c.options.showAnim?c.options.duration:null,a),c.options.showAnim&&c.options.duration||a())},_effectShow:function(o,e){this._effectGeneric(o,"show","slideDown","fadeIn",e)},_effectHide:function(o,e){this._effectGeneric(o,"hide","slideUp","fadeOut",e)},open:function(){var e,r,i,t,a,c,n,l,s,p=this
if(!p.opened){if(p._generate(),p.element.is(":hidden")?(s=o("<div/>").insertBefore(p.element),e=s.offset(),s.remove()):e=p.element.offset(),r=o(window).height()+o(window).scrollTop(),i=o(window).width()+o(window).scrollLeft(),t=p.dialog.outerHeight(!1),a=p.dialog.outerWidth(),c=e.left,n=e.top+p.element.outerHeight(!1),c+a>i&&(c=Math.max(0,i-a)),n+t>r&&(n=e.top-t>=o(window).scrollTop()?e.top-t:Math.max(0,r-t)),p.dialog.css({left:c,top:n}),l=0,o(p.element[0]).parents().each(function(){var e=o(this).css("z-index")
if("number"!=typeof e&&"string"!=typeof e||""===e||isNaN(e))o(this).siblings().each(function(){var e=o(this).css("z-index")
"number"!=typeof e&&"string"!=typeof e||""===e||isNaN(e)||e>l&&(l=parseInt(e,10))})
else if(e>l)return l=parseInt(e,10),!1}),p.dialog.css("z-index",l+=2),p.overlay=p.options.modal?new o.ui.dialog.overlay(p):null,null!==p.overlay){var u=p.overlay.$el.css("z-index")
"number"!=typeof u&&"string"!=typeof u||""===u||isNaN(u)||p.dialog.css("z-index",l+u+2)}p._effectShow(this.dialog),p.opened=!0,p._callback("open",!0),o(function(){p._repaintAllParts()})}},close:function(o){var e=this
o?(e.color=e.currentColor.copy(),e._change(e.color.set),e._callback("cancel",!0)):(e.currentColor=e.color.copy(),e._callback("ok",!0)),e.changed=!1,e._effectHide(e.dialog,function(){e.dialog.remove(),e.dialog=null,e.generated=!1,e.opened=!1,e._callback("close",!0)}),e.overlay&&e.overlay.destroy()},destroy:function(){this.element.unbind(),null!==this.image&&this.image.remove(),null!==this.button&&this.button.remove(),null!==this.dialog&&this.dialog.remove(),this.overlay&&this.overlay.destroy()},_callback:function(o,e){var r,i,t=this
return t.color.set?(r={formatted:t._formatColor(t.options.colorFormat,t.color),colorPicker:t},i=t.color.getLAB(),i.a=2*i.a-1,i.b=2*i.b-1,e===!0&&(r.a=t.color.getAlpha(),r.rgb=t.color.getRGB(),r.hsv=t.color.getHSV(),r.cmyk=t.color.getCMYK(),r.hsl=t.color.getHSL(),r.lab=i),t._trigger(o,null,r)):t._trigger(o,null,{formatted:"",colorPicker:t})},_initAllParts:function(){o.each(this.parts,function(o,e){e.init&&e.init()})},_updateAllParts:function(){o.each(this.parts,function(o,e){e.update&&e.update()})},_repaintAllParts:function(){o.each(this.parts,function(o,e){e.repaint&&e.repaint()})},_change:function(e){this.color.set=e!==!1,this.changed=!0,this.options.limit&&o.colorpicker.limits[this.options.limit]&&o.colorpicker.limits[this.options.limit](this.color,this),this.inline||(this.color.set?this.color.equals(this._parseColor(this.element.val()))||this.element.val(this._formatColor(this.options.colorFormat,this.color)):this.element.val(""),this._setImageBackground(),this._setAltField()),this.options.color=this.color.set?this.color.toCSS():"",this.opened&&this._repaintAllParts(),this._callback("select")},_hoverable:function(o){o.hover(function(){o.addClass("ui-state-hover")},function(){o.removeClass("ui-state-hover")})},_focusable:function(o){o.focus(function(){o.addClass("ui-state-focus")}).blur(function(){o.removeClass("ui-state-focus")})},_getRegional:function(e){return void 0!==o.colorpicker.regional[this.options.regional][e]?o.colorpicker.regional[this.options.regional][e]:o.colorpicker.regional[""][e]},_getSwatches:function(){return"string"==typeof this.options.swatches?o.colorpicker.swatches[this.options.swatches]:o.isPlainObject(this.options.swatches)?o.colorpicker.swatches:o.colorpicker.swatches.html},_getSwatch:function(e){var r=this._getSwatches(),i=!1
return void 0!==r[e]?r[e]:(o.each(r,function(o,r){return o.toLowerCase()==e.toLowerCase()?(i=r,!1):!0}),i)},_parseColor:function(e){var r,i=this
return o.each(o.colorpicker.parsers,function(o,t){return r=t(e,i),r?!1:void 0}),r?r:new o.colorpicker.Color},_exactName:function(e){var r=!1
return o.each(this._getSwatches(),function(i,t){return e.equals(new o.colorpicker.Color(t.r,t.g,t.b))?(r=i,!1):!0}),r},_closestName:function(e){var r,i=(e.getRGB(),null),t=!1
return o.each(this._getSwatches(),function(a,c){if(r=e.distance(new o.colorpicker.Color(c.r,c.g,c.b)),i>r||null===i){if(t=a,0===r)return!1
i=r}return!0}),t},_formatColor:function(e,r){var i=this,t=null,c={x:function(o){return a(255*o)},d:function(o){return Math.floor(255*o)},f:function(o){return o},p:function(o){return 100*o}},n=r.getChannels()
return o.isArray(e)||(e=[e]),o.each(e,function(e,a){return o.colorpicker.writers[a]?(t=o.colorpicker.writers[a](r,i),t===!1):(t=a.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(o){return o.match(/^\\/)?o.slice(1):c[o.charAt(1)](n[o.charAt(0)])}),!1)}),t}})}(jQuery)
